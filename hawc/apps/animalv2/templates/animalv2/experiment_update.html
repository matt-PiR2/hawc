{% extends 'assessment-rooted.html' %}

{% block content %}
<h2 class="d-inline-block">Update {{object.summary}}</h2>
<div class="float-right">
    <a id="experiment-update" class="btn btn-sm btn-primary" href="#"
        hx-get="{% url 'animalv2:experiment-update' object.pk %}" hx-target="#experiment-table" hx-swap="outerHTML">
        <i class="fa fa-pencil-square-o" aria-hidden="true"></i>&nbsp;Update experiment</a>
</div>

{% include "animalv2/fragments/_experiment_table.html" %}

<div class="card my-4 mx-2">
    <div class="card-body">
        {% url 'animalv2:chemical-create' object.pk as chemical_create %}
        {% include "animalv2/fragments/_create_card.html" with title="Chemicals" hx_get=chemical_create hx_target="#chemical-empty-row" %}
        <table class="table table-sm table-striped">
            {% bs4_colgroup '43,42,15' %}
            {% bs4_thead 'Name,CAS,DTXSID,Edit' %}
            <tbody>
                {% if object.v2_chemicals.all %}
                    {% for object in object.v2_chemicals.all %}
                        {% include "animalv2/fragments/_chemical_row.html" %}
                    {% endfor %}
                    {% include "animalv2/fragments/_create_one.html" with id="chemical-empty-row" text="" %}
                {% else %}
                    {% include "animalv2/fragments/_create_one.html" with id="chemical-empty-row" text="chemicals" %}
                {% endif %}
            </tbody>
        </table>
    </div>
</div>

<div class="card my-4 mx-2">
    <div class="card-body">
        {% url 'animalv2:animalgroup-create' object.pk as animalgroup_create %}
        {% include "animalv2/fragments/_create_card.html" with title="Animal Groups" hx_get=animalgroup_create hx_target="#animalgroup-empty-row" %}
        <table class="table table-sm table-striped">
            {% bs4_colgroup '35,15,15,15,20' %}
            {% bs4_thead 'Name,Species,Strain,Sex,Edit' %}
            <tbody>
                {% if object.v2_animal_groups.all %}
                    {% for object in object.v2_animal_groups.all %}
                        {% include "animalv2/fragments/_animalgroup_row.html" %}
                    {% endfor %}
                    {% include "animalv2/fragments/_create_one.html" with id="animalgroup-empty-row" text="" %}
                {% else %}
                    {% include "animalv2/fragments/_create_one.html" with id="animalgroup-empty-row" text="animal groups" %}
                {% endif %}
            </tbody>
        </table>
    </div>
</div>

<div class="card my-4 mx-2">
    <div class="card-body">
        {% url 'animalv2:treatment-create' object.pk as treatment_create %}
        {% include "animalv2/fragments/_create_card.html" with title="Treatments" hx_get=treatment_create hx_target="#treatment-empty-row" %}
        <table class="table table-sm table-striped">
            {% bs4_colgroup '45,35,20' %}
            {% bs4_thead 'Name,Chemical,Edit' %}
            <tbody>
                {% if object.v2_treatments.all %}
                    {% for object in object.v2_treatments.all %}
                        {% include "animalv2/fragments/_treatment_row.html" %}
                    {% endfor %}
                    {% include "animalv2/fragments/_create_one.html" with id="treatment-empty-row" text="" %}
                {% else %}
                    {% include "animalv2/fragments/_create_one.html" with id="treatment-empty-row" text="treatments" %}
                {% endif %}
            </tbody>
        </table>
    </div>
</div>

<div class="card my-4 mx-2">
    <div class="card-body">
        {% url 'animalv2:endpoint-create' object.pk as endpoint_create %}
        {% include "animalv2/fragments/_create_card.html" with title="Endpoints" hx_get=endpoint_create hx_target="#endpoint-empty-row" %}
        <table class="table table-sm table-striped">
            {% bs4_colgroup '30,20,20,20,10' %}
            {% bs4_thead 'Name,System,Organ,Effect,Edit' %}
            <tbody>
                {% if object.v2_endpoints.all %}
                    {% for object in object.v2_endpoints.all %}
                        {% include "animalv2/fragments/_endpoint_row.html" %}
                    {% endfor %}
                    {% include "animalv2/fragments/_create_one.html" with id="endpoint-empty-row" text="" %}
                {% else %}
                    {% include "animalv2/fragments/_create_one.html" with id="endpoint-empty-row" text="endpoints" %}
                {% endif %}
            </tbody>
        </table>
    </div>
</div>

<div class="card my-4 mx-2">
    <div class="card-body">
        {% url 'animalv2:observationtime-create' object.pk as observationtime_create %}
        {% include "animalv2/fragments/_create_card.html" with title="Endpoint Timepoints" hx_get=observationtime_create hx_target="#observationtime-empty-row" %}
        <table class="table table-sm table-striped">
            {% bs4_colgroup '30,30,30,10' %}
            {% bs4_thead 'Endpoint,Time,Units,Edit' %}
            <tbody>
                {% if object.v2_timepoints %}
                    {% for object in object.v2_timepoints %}
                        {% include "animalv2/fragments/_observationtime_row.html" %}
                    {% endfor %}
                    {% include "animalv2/fragments/_create_one.html" with id="observationtime-empty-row" text="" %}
                {% else %}
                    {% include "animalv2/fragments/_create_one.html" with id="observationtime-empty-row" text="endpoint timepoints" %}
                {% endif %}
            </tbody>
        </table>
    </div>
</div>

<div class="well text-center">
    <a class="btn btn-light my-3" href="{{object.get_absolute_url}}" id="animalv2-page-cancel"><i class="fa fa-fw fa-times"></i>Cancel</a>
</div>

{% endblock %}

{% block extrajs %}
{% include "common/htmx_autocomplete.html" %}
<script type="text/javascript">
window.app.startup("animalv2Startup", function(app){
  app.formStartup(document);
});
</script>
{% endblock %}
